<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QuickBrew Café — Menu</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
</head>
<body>
  <header class="topbar d-flex align-items-center">
    <div class="container d-flex align-items-center gap-3">
      <a href="index.html" class="text-white text-decoration-none"><strong>&larr; Home</strong></a>
      <h5 class="mb-0">Menu</h5>
      <div class="ms-auto">
        <a href="cart.html" class="btn btn-warning text-dark">Cart <span id="cart-badge">0</span></a>
      </div>
    </div>
  </header>

  <main class="container py-3">
    <div class="category-bar mb-3" id="categoryBar"></div>

    <div id="menuGrid" class="grid gap-3" style="display:grid;grid-template-columns:repeat(2,1fr);grid-auto-rows:1fr;gap:12px"></div>
  </main>

  <footer class="text-center py-3 small text-muted">Tip: Click Add to place item in cart.</footer>

  <script>
  let cart = JSON.parse(localStorage.getItem("cart")) || [];

  const menuItems = [
    {id:1,name:'Americano',price:120,image:'assets/americano.png',category:'Coffee'},
    {id:2,name:'Latte',price:150,image:'assets/latte.png',category:'Coffee'},
    {id:3,name:'Cappuccino',price:160,image:'assets/cappuccino.png',category:'Coffee'},
    {id:4,name:'Mocha',price:170,image:'assets/mocha.png',category:'Coffee'},
    {id:5,name:'Iced Coffee',price:140,image:'assets/iced_coffee.png',category:'Coffee'},
    {id:6,name:'Muffin',price:90,image:'assets/muffin.png',category:'Pastry'},
    {id:7,name:'Buko Pie',price:85,image:'assets/buko_pie.png',category:'Pastry'},
    {id:8,name:'Ensaymada',price:70,image:'assets/ensaymada.png',category:'Pastry'},
    {id:9,name:'Siopao',price:65,image:'assets/siopao.png',category:'Pastry'},
    {id:10,name:'Bagel',price:95,image:'assets/bagel.png',category:'Pastry'},
    {id:11,name:'Matcha',price:105,image: 'assets/matcha.png', category:'Coffee'}
  ];

  const categories = ['All','Coffee','Pastry'];

  function renderCategories(){
    const bar = document.getElementById('categoryBar'); 
    bar.innerHTML='';
    categories.forEach(c=>{
      const el = document.createElement('span');
      el.className='cat'+(c==='All'?' active':'');
      el.textContent = c;
      el.onclick = ()=>{
        document.querySelectorAll('.cat').forEach(x=>x.classList.remove('active'));
        el.classList.add('active');
        renderMenu(c);
      };
      bar.appendChild(el);
    });
  }

  function renderMenu(category='All'){
    const grid = document.getElementById('menuGrid'); 
    grid.innerHTML='';
    const items = category==='All'? menuItems : menuItems.filter(i=>i.category===category);

    items.forEach(it=>{
      const card = document.createElement('div');
      card.className='product-card';
      card.innerHTML = `
  <img src="${it.image}" alt="${it.name}">

  <div class="product-info">
    <h6>${it.name}</h6>
    <span class="text-muted">₱${it.price.toFixed(2)}</span>
  </div>

  <div class="add-holder">
    <button class="btn btn-sm btn-outline-secondary" onclick="addToCart(${it.id})">Add</button>
  </div>
`;

      grid.appendChild(card);

      setTimeout(()=>card.classList.add('show'), 100);
    });
  }

  function addToCart(id){
    const item = menuItems.find(x=>x.id===id);
    if(!item) return;

    const imgEl = document.querySelector(`img[src="${item.image}"]`);
    if(imgEl){
      const flyImg = imgEl.cloneNode(true);
      flyImg.classList.add('fly-img');
      document.body.appendChild(flyImg);

      const rect = imgEl.getBoundingClientRect();
      flyImg.style.left = rect.left + 'px';
      flyImg.style.top = rect.top + 'px';

      const badge = document.getElementById('cart-badge');
      const badgeRect = badge.getBoundingClientRect();

      setTimeout(()=>{
        flyImg.style.transform = `translate(${badgeRect.left-rect.left}px, ${badgeRect.top-rect.top}px) scale(0.3)`;
        flyImg.style.opacity = 0;
      },10);

      flyImg.addEventListener('transitionend', ()=>flyImg.remove());
    }

    const index = cart.findIndex(c=>c.id===id);
    if(index > -1){
      cart[index].qty += 1;
    } else {
      cart.push({ 
        id: item.id, 
        name: item.name, 
        price: item.price, 
        image: item.image,
        qty: 1
      });
    }

    localStorage.setItem("cart", JSON.stringify(cart));

    const badge = document.getElementById('cart-badge');
    badge.classList.add('animate-badge');
    setTimeout(()=>badge.classList.remove('animate-badge'),300);

    updateBadge();
  }

  function updateBadge(){
    const b = document.getElementById('cart-badge');
    const totalQty = cart.reduce((s,i)=>s+i.qty,0);

    b.style.display = totalQty>0 ? 'inline-block' : 'none';
    b.textContent = totalQty;
  }

  renderCategories();
  renderMenu();
  updateBadge();
</script>

</body>
</html>
